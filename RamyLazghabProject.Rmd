---
title: "Study on the Link Between Academic Path and Career Satisfaction"
author: "Ramy Lazghab"
date: "`r Sys.Date()`"
output: html_document
---

# Introduction
This report explores how the alignment between an individual's current role and their skills or education influences career satisfaction. We use Principal Component Analysis (PCA(ACP)) and Multiple Correspondence Analysis (MCA(ACM)) to examine the data.

```{r setup, include=FALSE}
# Load necessary libraries
library(tidyverse)
library(FactoMineR)
library(factoextra)
library(corrplot)
library(dplyr)
```

# Data Loading
We load the dataset from a CSV file and perform an initial inspection to understand its structure.

```{r load-data}
data <- read.csv("Data.csv", header = TRUE, sep = ",", fileEncoding = "ISO-8859-1")

# Inspect the dataset
str(data)          # Structure of the dataset
summary(data)      # Summary statistics
head(data)         # First few rows
# Check for duplicates
data <- distinct(data)
```

# Data Preprocessing
We recode Likert-scale responses and Yes/No(oui/Non) columns and prepare subsets of data for PCA(ACP) and MCA(ACM).

## Recoding Likert Responses
Likert responses in the "Pertinence," "Utilisation," and "Necessite" columns are recoded into numeric values.

```{r recode-likert}
# Recode Likert responses for Pertinence columns
pertinence_columns <- grep("Pertinence", names(data), value = TRUE)
data <- data %>%
  mutate(across(all_of(pertinence_columns), 
                ~ recode(., 
                         "pdtd" = 1, 
                         "Neutre" = 2, 
                         "tafd" = 3, 
                         .default = NA_real_)))

# Recode Likert responses for Utilisation columns
utilisation_columns <- grep("Utilisation", names(data), value = TRUE)
data <- data %>%
  mutate(across(all_of(utilisation_columns), 
                ~ recode(., 
                         "pdtd" = 1, 
                         "Neutre" = 2, 
                         "tafd" = 3, 
                         .default = NA_real_)))

# Recode Likert responses for Necessite columns
necessite_columns <- grep("Necessite", names(data), value = TRUE)
data <- data %>%
  mutate(across(all_of(necessite_columns), 
                ~ recode(., 
                         "pdtd" = 1, 
                         "Neutre" = 2, 
                         "tafd" = 3, 
                         .default = NA_real_)))

# Check the results
head(data)
```

## Recoding Yes/No(Oui/Non) Columns
Yes/No responses in the "Objectifs" columns are recoded to 1 for "Yes" and 0 for "No."

```{r recode-yesno}
# Select Oui/Non columns
yesno_columns <- grep("Objectifs", names(data), value = TRUE)

# Recode Yes/No responses to 1 for "Oui" and 0 for "Non"
data[yesno_columns] <- data[yesno_columns] %>%
  mutate(across(everything(), ~ recode(., "Oui" = 1, "Non" = 0)))

# Check the transformation
print(head(data[yesno_columns]))
```

## Verifying and Saving Preprocessed Data
We combine all rows and save the preprocessed data into a new CSV file.

```{r save-preprocessed-data}
write.csv(data, "preprocessed_data.csv", row.names = FALSE)
```

# Principal Component Analysis (PCA)
We prepare numerical data for PCA and verify if this method is appropriate by examining variable correlations.

## Preparing Data for PCA
We select only numerical columns and standardize the data.

```{r prepare-pca-data}
pca_data <- data %>% select(where(is.numeric))
# Impute missing values with column means
pca_data[is.na(pca_data)] <- apply(pca_data, 2, function(x) mean(x, na.rm = TRUE))

# Standardize the data
pca_data_scaled <- scale(pca_data)
```

## Checking Correlations
We check correlations between variables to determine if PCA is appropriate.

```{r check-correlations}
cor_matrix <- cor(pca_data_scaled, use = "complete.obs")
corrplot(cor_matrix, method = "circle", type = "upper", tl.col = "black", tl.srt = 45)
```

## Selecting Principal Components
We evaluate eigenvalues, cumulative variance, and scree plots to determine the number of components to retain.

```{r select-components}
# Eigenvalues and cumulative variance
eig <- get_eigenvalue(prcomp(pca_data_scaled))
print(eig)

# Scree plot for visualizing explained variance
fviz_screeplot(prcomp(pca_data_scaled), ncp = 10, addlabels = TRUE, ylim = c(0, 50))

# Kaiser criterion: components with eigenvalues > 1
eig_kaiser <- eig[eig$eigenvalue > 1, ]
print(paste("Number of components based on Kaiser Criterion:", nrow(eig_kaiser)))
```

## Performing PCA
We perform PCA and analyze variable contributions and individual projections.

```{r perform-pca}
# Perform PCA
pca_result <- prcomp(pca_data_scaled, center = TRUE, scale. = TRUE)

# Summary of PCA
summary(pca_result)

# Scree plot
screeplot(pca_result, main = "Scree Plot", col = "blue")

# Variable analysis
library(factoextra)
var <- get_pca_var(pca_result)
print(var$coord)   # Variable coordinates
print(var$contrib) # Contributions of variables
print(var$cos2)    # Cos² values

# Variable biplot
fviz_pca_var(pca_result, col.var = "cos2") +
  scale_color_gradient2(low = "white", mid = "blue", high = "red", midpoint = 0.6) +
  theme_minimal()

# Individual analysis
ind <- get_pca_ind(pca_result)
print(ind$coord)   # Individual coordinates
print(ind$cos2)    # Cos² values
print(ind$contrib) # Contributions of individuals

# Individual biplot
fviz_pca_ind(pca_result, geom = "point", col.ind = "cos2") +
  scale_color_gradient2(low = "blue", mid = "white", high = "red", midpoint = 0.5) +
  theme_minimal()
```

# Multiple Correspondence Analysis (MCA)
We prepare categorical data for MCA and analyze relationships between qualitative variables.

## Preparing Data for MCA(ACM)

```{r prepare-mca-data}
mca_data <- data %>%
  select(matches("Objectifs")) %>%
  mutate(across(everything(), as.factor))
# Remove columns with constant values or all NAs
mca_data <- mca_data[, sapply(mca_data, function(col) length(unique(na.omit(col))) > 1)]
```

## Performing MCA
Describe how categories are distributed and the relationships between individuals and categorical variables.

```{r perform-mca}
mca_result <- MCA(mca_data, graph = FALSE)

# Visualize MCA results
fviz_mca_biplot(mca_result, geom = "point", col.var = "blue", col.ind = "red")
```

# Conclusion
This report explored the relationships between academic paths and career satisfaction using PCA and MCA. The results helped identify key dimensions and qualitative relationships in the data.
